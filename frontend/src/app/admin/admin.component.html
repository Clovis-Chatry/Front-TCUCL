<!-- admin.component.html -->
<app-header></app-header>

<div class="admin-container">
  <!-- Section: Paramètres personnels -->
  <section class="card">
    <h2>Paramètres personnels</h2>
    <form>
      <label>Prénom</label>
      <input type="text" [(ngModel)]="user.firstName" name="firstName">

      <label>Nom</label>
      <input type="text" [(ngModel)]="user.lastName" name="lastName">

      <label>Email</label>
      <input type="email" [(ngModel)]="user.email" name="email">

      <button type="button" (click)="updateInfo()">Changer ses informations</button>
    </form>

    <button class="password-reset" (click)="sendPasswordReset()">Envoyer un mail de réinitialisation</button>
  </section>

  <!-- Section: Créer une entité -->
  <section class="card">
    <h2>Créer une entité</h2>
    <form>
      <label>Nom</label>
      <input type="text" [(ngModel)]="entity.name" name="entityName">

      <label>Type</label>
      <select [(ngModel)]="entity.type" name="entityType">
        <option>Enseignement Supérieur</option>
        <option>Collectivité</option>
      </select>

      <h4>Profil admin de l'entité</h4>
      <input type="text" placeholder="Prénom" [(ngModel)]="entity.admin.firstName" name="adminFirstName">
      <input type="text" placeholder="Nom" [(ngModel)]="entity.admin.lastName" name="adminLastName">
      <input type="email" placeholder="Email" [(ngModel)]="entity.admin.email" name="adminEmail">

      <button type="button" (click)="createEntity()">Créer l'entité</button>
    </form>
  </section>

  <!-- Section: Ajouter un utilisateur -->
  <section class="card">
    <h2>Ajouter un utilisateur à une entité</h2>
    <form>
      <select [(ngModel)]="newUserEntity" name="newUserEntity">
        <option *ngFor="let e of entities">{{ e.name }}</option>
      </select>

      <input placeholder="Prénom" [(ngModel)]="newUser.firstName" name="newUserFirstName">
      <input placeholder="Nom" [(ngModel)]="newUser.lastName" name="newUserLastName">
      <input placeholder="E-mail" [(ngModel)]="newUser.email" name="newUserEmail">

      <label><input type="checkbox" [(ngModel)]="newUser.isAdmin" name="newUserIsAdmin"> Admin</label>

      <button type="button" (click)="addUser()">Ajouter l'utilisateur</button>
    </form>
  </section>

  <!-- Section: Gestion des utilisateurs -->
  <section class="card">
    <h2>Gestion des utilisateurs</h2>
    <select [(ngModel)]="selectedEntity" name="selectedEntity">
      <option *ngFor="let e of entities" [value]="e.name">{{ e.name }}</option>
    </select>

    <table>
      <thead>
        <tr><th>NOM</th><th>Prénom</th><th>Admin</th><th>Action</th></tr>
      </thead>
      <tbody>
        <tr *ngFor="let user of filteredUsers()">
          <td>{{ user.lastName }}</td>
          <td>{{ user.firstName }}</td>
          <td><input type="checkbox" [checked]="user.isAdmin"></td>
          <td>
            <button>Edit</button>
            <button>Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </section>
</div>
