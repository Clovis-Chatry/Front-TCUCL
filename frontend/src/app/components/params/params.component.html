<!-- Bouton de retour -->
<div class="top-bar">
  <button class="back-button" (click)="goBackToDashboard()">Accueil</button>
</div>

<div class="params-container">

  <!-- Section: Param√®tres personnels -->
  <section class="card" data-title="Param√®tres personnels">
    <form>
      <label>Pr√©nom</label>
      <input type="text" [(ngModel)]="user.firstName" name="firstName">

      <label>Nom</label>
      <input type="text" [(ngModel)]="user.lastName" name="lastName">

      <label>Email</label>
      <input type="email" [(ngModel)]="user.email" name="email">

      <button type="button" (click)="updateInfo()">Changer ses informations</button>
    </form>
  </section>

  <!-- Section: R√©initialisation mot de passe -->
  <section class="card" data-title="Changer son mot de passe">
    <button class="password-reset" (click)="sendPasswordReset()">Envoyer un mail de r√©initialisation</button>
  </section>

  <!-- Grille des blocs params -->
  <div class="params-grid">
    <!-- Section: Cr√©er une entit√© -->
    <section class="card" data-title="Cr√©er une entit√©">
      <form>

        <p class="section-info">Param√®tres de l'entit√©</p>

        <label>Nom</label>
        <input type="text" [(ngModel)]="entity.name" name="entityName">

        <label>Type</label>
        <select [(ngModel)]="entity.type" name="entityType">
          <option>Enseignement Sup√©rieur</option>
          <option>Collectivit√©</option>
        </select>

        <p class="section-info">Profil du premier admin de l'entit√©</p>

        <label>Pr√©nom</label>
        <input type="text" placeholder="Pr√©nom" [(ngModel)]="entity.admin.firstName" name="adminFirstName">

        <label>Nom</label>
        <input type="text" placeholder="Nom" [(ngModel)]="entity.admin.lastName" name="adminLastName">

        <label>Email</label>
        <input type="email" placeholder="Email" [(ngModel)]="entity.admin.email" name="adminEmail">

        <button type="button" (click)="createEntity()">Cr√©er l'entit√©</button>
      </form>
    </section>

    <!-- Section: Ajouter un utilisateur -->
    <section class="card" data-title="Ajouter un utilisateur √† une entit√©">
      <form>
        <label>S√©lectionner l'entit√©</label>
        <select [(ngModel)]="newUserEntity" name="newUserEntity">
          <option *ngFor="let e of entities">{{ e.name }}</option>
        </select>

        <label>Pr√©nom</label>
        <input type="text" placeholder="Pr√©nom" [(ngModel)]="entity.admin.firstName" name="adminFirstName">

        <label>Nom</label>
        <input type="text" placeholder="Nom" [(ngModel)]="entity.admin.lastName" name="adminLastName">

        <label>Email</label>
        <input type="email" placeholder="Email" [(ngModel)]="entity.admin.email" name="adminEmail">

<div class="checkbox-line">
  <input type="checkbox" id="adminCheckbox" [(ngModel)]="entity.admin.isAdmin" name="adminIsAdmin">
  <label for="adminCheckbox">Utilisateur avec r√¥le "Admin"</label>
</div>

      </form>
      <button type="button" (click)="addUser()">Ajouter l'utilisateur</button>
    </section>

    <!-- Section: Gestion des utilisateurs -->
    <section class="card" data-title="Gestion des utilisateurs">
      <label>Entit√© :</label>
      <select [(ngModel)]="selectedEntity" name="selectedEntity">
        <option *ngFor="let e of entities" [value]="e.name">{{ e.name }}</option>
      </select>

      <table class="user-table">
        <thead>
          <tr><th>NOM</th><th>Pr√©nom</th><th>admin</th><th>Action</th></tr>
        </thead>
        <tbody>
          <tr *ngFor="let user of filteredUsers()">
            <td>{{ user.lastName }}</td>
            <td>{{ user.firstName }}</td>
            <td><input type="checkbox" [checked]="user.isAdmin" disabled></td>
            <td>
              <button title="Modifier">‚úèÔ∏è</button>
              <button title="Supprimer">üóëÔ∏è</button>
            </td>
          </tr>
        </tbody>
      </table>
    </section>
  </div>
</div>
